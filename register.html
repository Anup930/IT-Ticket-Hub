<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome - IT Ticket Hub</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    body { background: #f8fafc; font-family: 'Inter', sans-serif; display: flex; align-items: center; justify-content: center; min-height: 100vh; padding: 20px; }
    .option-card { cursor: pointer; transition: 0.3s; border: 2px solid transparent; }
    .option-card:hover { transform: translateY(-5px); border-color: #4f46e5; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
    .form-section { display: none; animation: fadeIn 0.5s; }
    @keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }
  </style>
</head>
<body>

  <div class="container" style="max-width: 500px;">
    
    <div id="selectionScreen" class="text-center">
      <div class="mb-5">
        <i class="fa-solid fa-layer-group text-primary" style="font-size: 3rem;"></i>
        <h3 class="fw-bold mt-3">Welcome to IT Ticket Hub</h3>
        <p class="text-muted">Please select an option to proceed</p>
      </div>

      <div class="row g-3">
        <div class="col-6">
          <div class="card option-card p-4 h-100" onclick="window.location.href='index.html'">
            <div class="text-primary mb-3"><i class="fas fa-user-check fa-2x"></i></div>
            <h6 class="fw-bold">Existing Employee</h6>
            <small class="text-muted">Login Here</small>
          </div>
        </div>
        <div class="col-6">
          <div class="card option-card p-4 h-100" onclick="showRegistration()">
            <div class="text-success mb-3"><i class="fas fa-user-plus fa-2x"></i></div>
            <h6 class="fw-bold">New User</h6>
            <small class="text-muted">Register Here</small>
          </div>
        </div>
      </div>
    </div>

    <div id="registerScreen" class="form-section">
      <div class="card shadow border-0">
        <div class="card-header bg-white border-0 pt-4 px-4">
          <button class="btn btn-sm btn-light mb-2" onclick="showSelection()"><i class="fas fa-arrow-left me-2"></i>Back</button>
          <h4 class="fw-bold">New Registration</h4>
          <p class="text-muted small">Fill details to request access</p>
        </div>
        <div class="card-body p-4">
          <form id="regForm">
            <div class="mb-3"><label class="small fw-bold text-muted">Full Name</label><input type="text" id="rName" class="form-control" required></div>
            <div class="mb-3"><label class="small fw-bold text-muted">Email ID</label><input type="email" id="rEmail" class="form-control" required></div>
            <div class="row">
              <div class="col-6 mb-3"><label class="small fw-bold text-muted">Emp ID</label><input type="text" id="rEmpId" class="form-control" required></div>
              <div class="col-6 mb-3"><label class="small fw-bold text-muted">Phone</label><input type="text" id="rPhone" class="form-control" required></div>
            </div>
            <div class="mb-3"><label class="small fw-bold text-muted">Location / Branch</label><input type="text" id="rLoc" class="form-control" required></div>
            
            <button type="submit" id="subBtn" class="btn btn-primary w-100 py-2">Submit Request</button>
          </form>
        </div>
      </div>
    </div>

  </div>

<script>
  // *** PASTE YOUR GOOGLE SCRIPT DEPLOYED URL HERE ***
  const API_URL = "https://script.google.com/macros/s/AKfycbzOk6hCXbs51Hddw322AY4wMyw6xYQxK2O_uh6ui28pU4BsiOmtLsLBjSC0Od7igvjH/exec"; 

  function showRegistration() {
    document.getElementById('selectionScreen').style.display = 'none';
    document.getElementById('registerScreen').style.display = 'block';
  }
  function showSelection() {
    document.getElementById('registerScreen').style.display = 'none';
    document.getElementById('selectionScreen').style.display = 'block';
  }

  document.getElementById('regForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const btn = document.getElementById('subBtn');
    btn.disabled = true; btn.innerText = "Submitting...";

    const payload = {
      action: 'registerUser',
      name: document.getElementById('rName').value,
      email: document.getElementById('rEmail').value,
      empId: document.getElementById('rEmpId').value,
      phone: document.getElementById('rPhone').value,
      location: document.getElementById('rLoc').value
    };

    fetch(API_URL, { method: 'POST', body: JSON.stringify(payload) })
    .then(r => r.json()).then(d => {
      if(d.success) {
        document.body.innerHTML = `
          <div class="text-center p-5">
            <i class="fas fa-check-circle text-success" style="font-size: 4rem;"></i>
            <h3 class="mt-3 fw-bold">Request Sent!</h3>
            <p class="text-muted">You will receive an email once Admin approves your request.</p>
            <a href="index.html" class="btn btn-outline-primary mt-3">Back to Login</a>
          </div>`;
      } else { 
        alert(d.message); 
        btn.disabled=false; 
        btn.innerText="Submit Request"; 
      }
    })
    .catch(err => {
       alert("Error: " + err);
       btn.disabled=false;
       btn.innerText="Submit Request";
    });
  });
</script>
</body>
</html>
